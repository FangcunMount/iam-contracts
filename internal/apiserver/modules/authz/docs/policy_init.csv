# Casbin 策略初始化示例
# 格式说明：
# p 规则：p, 角色, 租户, 资源, 动作
# g 规则：g, 用户/组, 角色, 租户

# ============================================
# 租户 t1 的策略配置
# ============================================

# --- 角色：量表编辑员 (scale-editor) ---
# 可以创建量表、查看和编辑自己的量表
p,role:scale-editor,t1,scale:form:*,create
p,role:scale-editor,t1,scale:form:*,read_own
p,role:scale-editor,t1,scale:form:*,update_own
p,role:scale-editor,t1,scale:form:*,delete_own

# --- 角色：量表审批员 (scale-reviewer) ---
# 可以查看所有量表、审批量表
p,role:scale-reviewer,t1,scale:form:*,read_all
p,role:scale-reviewer,t1,scale:form:*,approve

# --- 角色：量表管理员 (scale-admin) ---
# 可以执行所有量表相关操作
p,role:scale-admin,t1,scale:form:*,create
p,role:scale-admin,t1,scale:form:*,read_all
p,role:scale-admin,t1,scale:form:*,update_all
p,role:scale-admin,t1,scale:form:*,delete_all
p,role:scale-admin,t1,scale:form:*,approve
p,role:scale-admin,t1,scale:form:*,export

# --- 角色：报告查看员 (report-viewer) ---
# 可以查看和导出报告
p,role:report-viewer,t1,scale:report:*,read_all
p,role:report-viewer,t1,scale:report:*,export

# --- 角色：运营管理员 (ops-admin) ---
# 可以管理用户、角色和权限
p,role:ops-admin,t1,ops:user:*,read_all
p,role:ops-admin,t1,ops:user:*,update_all
p,role:ops-admin,t1,ops:user:*,disable_all
p,role:ops-admin,t1,ops:role:*,create
p,role:ops-admin,t1,ops:role:*,read_all
p,role:ops-admin,t1,ops:role:*,update_all
p,role:ops-admin,t1,ops:role:*,delete_all
p,role:ops-admin,t1,ops:permission:*,read_all
p,role:ops-admin,t1,ops:permission:*,update_all

# ============================================
# 用户角色赋权 (g 规则)
# ============================================

# 用户 1001 是量表编辑员
g,user:1001,role:scale-editor,t1

# 用户 2002 是量表审批员
g,user:2002,role:scale-reviewer,t1

# 用户 3003 是量表管理员
g,user:3003,role:scale-admin,t1

# 用户 4004 是报告查看员
g,user:4004,role:report-viewer,t1

# 用户 9999 是运营管理员（超级管理员）
g,user:9999,role:ops-admin,t1
g,user:9999,role:scale-admin,t1

# ============================================
# 租户 t2 的策略配置（示例）
# ============================================

# 租户 t2 的量表编辑员
p,role:scale-editor,t2,scale:form:*,create
p,role:scale-editor,t2,scale:form:*,read_own
p,role:scale-editor,t2,scale:form:*,update_own

# 租户 t2 的用户赋权
g,user:5001,role:scale-editor,t2
