basePath: /api/v1
definitions:
  github_com_FangcunMount_iam-contracts_internal_apiserver_domain_authn_jwks.PublicJWK:
    properties:
      alg:
        description: '"RS256"/"ES256"/"EdDSA"'
        type: string
      crv:
        type: string
      e:
        type: string
      kid:
        description: key id
        type: string
      kty:
        description: '"RSA"/"EC"/"OKP"'
        type: string
      "n":
        description: 'RSA: n/e; EC: crv/x/y; OKP: crv/x'
        type: string
      use:
        description: '"sig"'
        type: string
      x:
        type: string
      "y":
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.CreateKeyRequest:
    properties:
      algorithm:
        description: 签名算法
        enum:
        - RS256
        - RS384
        - RS512
        type: string
      notAfter:
        description: 过期时间（可选）
        type: string
      notBefore:
        description: 生效时间（可选）
        type: string
    required:
    - algorithm
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.LoginRequest:
    properties:
      credentials:
        description: 凭证（根据 method 不同而不同）
        items:
          type: integer
        type: array
      device_id:
        description: 设备 ID
        type: string
      method:
        description: 认证方式：password | phone_otp | wechat | wecom
        type: string
    required:
    - credentials
    - method
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.LogoutRequest:
    properties:
      access_token:
        description: 可选，撤销访问令牌
        type: string
      refresh_token:
        description: 可选，撤销刷新令牌
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.RefreshTokenRequest:
    properties:
      refresh_token:
        type: string
    required:
    - refresh_token
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.RegisterWeChatAccountReq:
    properties:
      appId:
        description: 微信应用ID
        type: string
      avatar:
        description: 微信头像（可选）
        type: string
      email:
        description: 邮箱（可选）
        type: string
      jsCode:
        description: 微信登录凭证（临时登录凭证）
        type: string
      meta:
        additionalProperties: true
        description: 微信元数据（可选）
        type: object
      name:
        description: 用户名
        type: string
      nickname:
        description: 微信昵称（可选）
        type: string
      phone:
        description: 手机号（可选）
        type: string
    required:
    - appId
    - jsCode
    - name
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.SetWeChatUnionIDReq:
    properties:
      unionId:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.UpsertWeChatProfileReq:
    properties:
      avatar:
        type: string
      meta:
        additionalProperties: true
        type: object
      nickname:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.VerifyTokenRequest:
    properties:
      access_token:
        type: string
    required:
    - access_token
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.Account:
    properties:
      appId:
        type: string
      externalId:
        type: string
      id:
        type: string
      provider:
        type: string
      status:
        type: string
      userId:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.CleanupResponse:
    properties:
      deletedCount:
        description: 删除的密钥数量
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyInfo:
    properties:
      algorithm:
        description: 签名算法
        type: string
      createdAt:
        description: 创建时间
        type: string
      kid:
        description: 密钥 ID
        type: string
      notAfter:
        description: 过期时间
        type: string
      notBefore:
        description: 生效时间
        type: string
      publicJwk:
        allOf:
        - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_domain_authn_jwks.PublicJWK'
        description: 公钥 JWK
      status:
        description: 密钥状态
        type: string
      updatedAt:
        description: 更新时间
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyListResponse:
    properties:
      keys:
        description: 密钥列表
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyInfo'
        type: array
      limit:
        description: 每页数量
        type: integer
      offset:
        description: 偏移量
        type: integer
      total:
        description: 总数
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyResponse:
    properties:
      algorithm:
        description: 签名算法
        type: string
      createdAt:
        description: 创建时间
        type: string
      kid:
        description: 密钥 ID
        type: string
      notAfter:
        description: 过期时间
        type: string
      notBefore:
        description: 生效时间
        type: string
      publicJwk:
        allOf:
        - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_domain_authn_jwks.PublicJWK'
        description: 公钥 JWK
      status:
        description: 密钥状态 (active, grace, retired)
        type: string
      updatedAt:
        description: 更新时间
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse:
    properties:
      message:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.PublishableKeyInfo:
    properties:
      algorithm:
        description: 签名算法
        type: string
      kid:
        description: 密钥 ID
        type: string
      notAfter:
        description: 过期时间
        type: string
      notBefore:
        description: 生效时间
        type: string
      publicJwk:
        allOf:
        - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_domain_authn_jwks.PublicJWK'
        description: 公钥 JWK
      status:
        description: 密钥状态
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.PublishableKeysResponse:
    properties:
      keys:
        description: 可发布的密钥列表
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.PublishableKeyInfo'
        type: array
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.RegisterResult:
    properties:
      accountId:
        type: integer
      accountType:
        type: string
      credentialID:
        type: integer
      email:
        type: string
      externalId:
        type: string
      isNewAccount:
        type: boolean
      isNewUser:
        type: boolean
      phone:
        type: string
      userId:
        type: integer
      userName:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenClaims:
    properties:
      account_id:
        description: 账户 ID
        type: string
      expires_at:
        description: 过期时间
        type: string
      issued_at:
        description: 签发时间
        type: string
      issuer:
        description: 签发者
        type: string
      jti:
        description: JWT ID（可选）
        type: string
      kid:
        description: Key ID（可选）
        type: string
      tenant_id:
        description: 租户 ID（可选）
        type: integer
      user_id:
        description: 用户 ID
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenPair:
    properties:
      access_token:
        description: 访问令牌
        type: string
      expires_in:
        description: 过期时间（秒）
        type: integer
      refresh_token:
        description: 刷新令牌（可选）
        type: string
      token_type:
        description: 令牌类型（Bearer）
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenVerifyResponse:
    properties:
      claims:
        allOf:
        - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenClaims'
        description: 令牌声明（如果有效）
      valid:
        description: 令牌是否有效
        type: boolean
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AddPolicyRequest:
    properties:
      action:
        type: string
      changed_by:
        type: string
      reason:
        type: string
      resource_id:
        type: integer
      role_id:
        type: integer
    required:
    - action
    - changed_by
    - resource_id
    - role_id
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AssignmentResponse:
    properties:
      granted_by:
        type: string
      id:
        type: integer
      role_id:
        type: integer
      subject_id:
        type: string
      subject_type:
        type: string
      tenant_id:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.CreateResourceRequest:
    properties:
      actions:
        items:
          type: string
        minItems: 1
        type: array
      app_name:
        type: string
      description:
        type: string
      display_name:
        type: string
      domain:
        type: string
      key:
        type: string
      type:
        type: string
    required:
    - actions
    - app_name
    - display_name
    - domain
    - key
    - type
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.CreateRoleRequest:
    properties:
      description:
        type: string
      display_name:
        type: string
      name:
        type: string
    required:
    - display_name
    - name
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.GrantRequest:
    properties:
      granted_by:
        type: string
      role_id:
        type: integer
      subject_id:
        type: string
      subject_type:
        enum:
        - user
        - group
        type: string
    required:
    - granted_by
    - role_id
    - subject_id
    - subject_type
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ListResponse:
    properties:
      code:
        type: integer
      data: {}
      limit:
        type: integer
      message:
        type: string
      offset:
        type: integer
      total:
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.PolicyRuleResponse:
    properties:
      action:
        type: string
      domain:
        type: string
      object:
        type: string
      subject:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.PolicyVersionResponse:
    properties:
      changed_by:
        type: string
      reason:
        type: string
      tenant_id:
        type: string
      version:
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RemovePolicyRequest:
    properties:
      action:
        type: string
      changed_by:
        type: string
      reason:
        type: string
      resource_id:
        type: integer
      role_id:
        type: integer
    required:
    - action
    - changed_by
    - resource_id
    - role_id
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse:
    properties:
      actions:
        items:
          type: string
        type: array
      app_name:
        type: string
      description:
        type: string
      display_name:
        type: string
      domain:
        type: string
      id:
        type: integer
      key:
        type: string
      type:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response:
    properties:
      code:
        type: integer
      data: {}
      message:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RevokeRequest:
    properties:
      role_id:
        type: integer
      subject_id:
        type: string
      subject_type:
        enum:
        - user
        - group
        type: string
    required:
    - role_id
    - subject_id
    - subject_type
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RoleResponse:
    properties:
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      name:
        type: string
      tenant_id:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.UpdateResourceRequest:
    properties:
      actions:
        items:
          type: string
        minItems: 1
        type: array
      description:
        type: string
      display_name:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.UpdateRoleRequest:
    properties:
      description:
        type: string
      display_name:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ValidateActionRequest:
    properties:
      action:
        type: string
      resource_key:
        type: string
    required:
    - action
    - resource_key
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ValidateActionResponse:
    properties:
      valid:
        type: boolean
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.CreateWechatAppRequest:
    properties:
      app_id:
        description: 微信应用 ID（必填）
        type: string
      app_secret:
        description: AppSecret（可选，创建时设置）
        type: string
      name:
        description: 应用名称（必填）
        type: string
      type:
        description: 应用类型（MiniProgram/OfficialAccount，必填）
        type: string
    required:
    - app_id
    - name
    - type
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RefreshAccessTokenRequest:
    properties:
      app_id:
        description: 微信应用 ID
        type: string
    required:
    - app_id
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RotateAuthSecretRequest:
    properties:
      app_id:
        description: 微信应用 ID
        type: string
      new_secret:
        description: 新的 AppSecret
        type: string
    required:
    - app_id
    - new_secret
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RotateMsgSecretRequest:
    properties:
      app_id:
        description: 微信应用 ID
        type: string
      callback_token:
        description: 回调 Token
        type: string
      encoding_aes_key:
        description: 加密 AES Key
        type: string
    required:
    - app_id
    - callback_token
    - encoding_aes_key
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.AccessTokenResponse:
    properties:
      access_token:
        description: 访问令牌
        type: string
      expires_in:
        description: 过期时间（秒）
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse:
    properties:
      code:
        description: 错误码
        type: integer
      message:
        description: 错误消息
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.RotateSecretResponse:
    properties:
      message:
        description: 消息
        type: string
      success:
        description: 是否成功
        type: boolean
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.WechatAppResponse:
    properties:
      app_id:
        description: 微信应用 ID
        type: string
      id:
        description: 内部 ID
        type: string
      name:
        description: 应用名称
        type: string
      status:
        description: 应用状态（Active/Inactive）
        type: string
      type:
        description: 应用类型（MiniProgram/OfficialAccount）
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.ChildRegisterRequest:
    properties:
      dob:
        type: string
      gender:
        type: integer
      heightCm:
        type: integer
      idNo:
        type: string
      idType:
        type: string
      legalName:
        type: string
      relation:
        enum:
        - self
        - parent
        - guardian
        type: string
      weightKg:
        type: string
    required:
    - dob
    - gender
    - legalName
    - relation
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.ChildUpdateRequest:
    properties:
      dob:
        type: string
      gender:
        type: integer
      heightCm:
        type: integer
      legalName:
        type: string
      weightKg:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.GuardianGrantRequest:
    properties:
      childId:
        type: string
      relation:
        enum:
        - self
        - parent
        - guardian
        type: string
      userId:
        type: string
    required:
    - childId
    - relation
    - userId
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.UserContactUpsert:
    properties:
      type:
        enum:
        - email
        - phone
        type: string
      value:
        type: string
    required:
    - type
    - value
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.UserUpdateRequest:
    properties:
      avatar:
        type: string
      contacts:
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.UserContactUpsert'
        type: array
      nickname:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildPageResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildResponse'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildRegisterResponse:
    properties:
      child:
        $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildResponse'
      guardianship:
        $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipResponse'
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildResponse:
    properties:
      createdAt:
        type: string
      dob:
        type: string
      gender:
        type: integer
      heightCm:
        type: integer
      id:
        type: string
      idMasked:
        type: string
      idType:
        type: string
      legalName:
        type: string
      updatedAt:
        type: string
      weightKg:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipPageResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipResponse'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipResponse:
    properties:
      childId:
        type: string
      id:
        type: integer
      relation:
        type: string
      revokedAt:
        type: string
      since:
        type: string
      userId:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.UserResponse:
    properties:
      avatar:
        type: string
      contacts:
        items:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.VerifiedContactResponse'
        type: array
      createdAt:
        type: string
      id:
        type: string
      nickname:
        type: string
      status:
        type: string
      updatedAt:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.VerifiedContactResponse:
    properties:
      type:
        type: string
      value:
        type: string
      verifiedAt:
        type: string
    type: object
  github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse:
    properties:
      code:
        description: Code 定义了业务错误代码
        type: integer
      message:
        description: |-
          Message 包含此消息的详细信息
          此消息适合暴露给外部
        type: string
      reference:
        description: Reference 返回参考文档，可能有助于解决此错误
        type: string
    type: object
host: iam.yangshujie.com
info:
  contact:
    email: support@yangshujie.com
    name: API Support
    url: https://github.com/FangcunMount/iam-contracts
  description: IAM 系统 REST API 文档，包含认证(Authentication)、授权(Authorization)、身份管理(Identity)和身份提供商(IDP)模块
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: https://iam.yangshujie.com/terms
  title: IAM API Documentation
  version: 1.0.0
paths:
  /.well-known/jwks.json:
    get:
      description: 获取 JSON Web Key Set，用于验证 JWT 签名
      produces:
      - application/json
      responses:
        "200":
          description: JWKS JSON
          headers:
            Cache-Control:
              description: 缓存控制
              type: string
            ETag:
              description: 实体标签
              type: string
            Last-Modified:
              description: 最后修改时间
              type: string
          schema:
            additionalProperties: true
            type: object
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      summary: 获取 JWKS
      tags:
      - Authentication-JWKS
  /accounts/{accountId}:
    get:
      consumes:
      - application/json
      description: 根据账户ID获取账户详细信息
      parameters:
      - description: 账户ID
        in: path
        name: accountId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 账户信息
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.Account'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 账户不存在
          schema:
            additionalProperties: true
            type: object
      summary: 获取账户信息
      tags:
      - 账户管理
  /accounts/{accountId}/disable:
    post:
      description: 将账户标记为禁用，阻止继续认证
      parameters:
      - description: 账户ID
        in: path
        name: accountId
        required: true
        type: string
      responses:
        "200":
          description: 禁用成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 账户不存在
          schema:
            additionalProperties: true
            type: object
      summary: 禁用账户
      tags:
      - 账户管理
  /accounts/{accountId}/enable:
    post:
      description: 恢复已禁用的账户
      parameters:
      - description: 账户ID
        in: path
        name: accountId
        required: true
        type: string
      responses:
        "200":
          description: 启用成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 账户不存在
          schema:
            additionalProperties: true
            type: object
      summary: 启用账户
      tags:
      - 账户管理
  /accounts/{accountId}/profile:
    put:
      consumes:
      - application/json
      description: 更新微信账户的昵称、头像等资料信息
      parameters:
      - description: 账户ID
        in: path
        name: accountId
        required: true
        type: string
      - description: 更新资料请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.UpsertWeChatProfileReq'
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 账户不存在
          schema:
            additionalProperties: true
            type: object
      summary: 更新账户资料
      tags:
      - 账户管理
  /accounts/{accountId}/unionid:
    put:
      consumes:
      - application/json
      description: 将微信账户的 UnionID 与内部账户关联
      parameters:
      - description: 账户ID
        in: path
        name: accountId
        required: true
        type: string
      - description: 设置 UnionID 请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.SetWeChatUnionIDReq'
      produces:
      - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 账户不存在
          schema:
            additionalProperties: true
            type: object
      summary: 设置账户 UnionID
      tags:
      - 账户管理
  /accounts/wechat/register:
    post:
      consumes:
      - application/json
      description: 使用微信 JS Code 注册新用户，服务端根据 AppID 查询 AppSecret 并自动调用 code2session
        获取 OpenID 和 UnionID
      parameters:
      - description: 微信注册请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.RegisterWeChatAccountReq'
      produces:
      - application/json
      responses:
        "201":
          description: 注册成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.RegisterResult'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "409":
          description: 用户已存在
          schema:
            additionalProperties: true
            type: object
      summary: 微信用户注册
      tags:
      - 账户管理
  /admin/jwks/keys:
    get:
      description: 分页列出所有密钥
      parameters:
      - description: 状态过滤 (active, grace, retired)
        in: query
        name: status
        type: string
      - default: 20
        description: 每页数量
        in: query
        name: limit
        type: integer
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 密钥列表
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyListResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 列出密钥
      tags:
      - Authentication-JWKS
    post:
      consumes:
      - application/json
      description: 创建新的签名密钥
      parameters:
      - description: 创建密钥请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.CreateKeyRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 创建成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 创建密钥
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/{kid}:
    get:
      description: 根据 kid 获取密钥详细信息
      parameters:
      - description: 密钥 ID
        in: path
        name: kid
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 密钥详情
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.KeyResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 密钥不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 获取密钥详情
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/{kid}/force-retire:
    post:
      description: 强制将任何状态的密钥转为 Retired（用于紧急情况）
      parameters:
      - description: 密钥 ID
        in: path
        name: kid
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: 强制退役成功
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 密钥不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 强制退役密钥
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/{kid}/grace:
    post:
      description: 将密钥状态从 Active 转为 Grace
      parameters:
      - description: 密钥 ID
        in: path
        name: kid
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: 进入宽限期成功
        "400":
          description: 参数错误或状态不允许
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 密钥不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 进入宽限期
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/{kid}/retire:
    post:
      description: 将密钥状态从 Grace 转为 Retired
      parameters:
      - description: 密钥 ID
        in: path
        name: kid
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: 退役成功
        "400":
          description: 参数错误或状态不允许
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 密钥不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 退役密钥
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/cleanup:
    post:
      description: 删除已过期的 Retired 密钥
      produces:
      - application/json
      responses:
        "200":
          description: 清理结果
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.CleanupResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 清理过期密钥
      tags:
      - Authentication-JWKS
  /admin/jwks/keys/publishable:
    get:
      description: 获取当前会被发布到 JWKS 的密钥列表（用于预览或调试）
      produces:
      - application/json
      responses:
        "200":
          description: 可发布的密钥列表
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.PublishableKeysResponse'
        "401":
          description: 未认证
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 获取可发布的密钥
      tags:
      - Authentication-JWKS
  /auth/login:
    post:
      consumes:
      - application/json
      description: 支持多种登录方式：密码登录、手机验证码登录、微信小程序登录、企业微信登录
      parameters:
      - description: 登录请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 登录成功，返回访问令牌和刷新令牌
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenPair'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "401":
          description: 认证失败
          schema:
            additionalProperties: true
            type: object
      summary: 用户登录
      tags:
      - 认证
  /auth/logout:
    post:
      consumes:
      - application/json
      description: 撤销访问令牌和刷新令牌
      parameters:
      - description: 登出请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.LogoutRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 登出成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.MessageResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
      summary: 用户登出
      tags:
      - 认证
  /auth/refresh_token:
    post:
      consumes:
      - application/json
      description: 使用刷新令牌获取新的访问令牌
      parameters:
      - description: 刷新令牌请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.RefreshTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 刷新成功，返回新的访问令牌
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenPair'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "401":
          description: 刷新令牌无效或已过期
          schema:
            additionalProperties: true
            type: object
      summary: 刷新访问令牌
      tags:
      - 认证
  /auth/verify:
    post:
      consumes:
      - application/json
      description: 验证访问令牌的有效性并返回声明信息
      parameters:
      - description: 验证令牌请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_request.VerifyTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 验证成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authn_restful_response.TokenVerifyResponse'
        "400":
          description: 请求参数错误
          schema:
            additionalProperties: true
            type: object
        "401":
          description: 令牌无效
          schema:
            additionalProperties: true
            type: object
      summary: 验证访问令牌
      tags:
      - 认证
  /authz/assignments/{id}:
    delete:
      parameters:
      - description: 分配ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 根据分配ID撤销角色
      tags:
      - Authorization-Assignments
  /authz/assignments/grant:
    post:
      consumes:
      - application/json
      parameters:
      - description: 授予角色请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.GrantRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AssignmentResponse'
              type: object
      summary: 授予角色
      tags:
      - Authorization-Assignments
  /authz/assignments/revoke:
    post:
      consumes:
      - application/json
      parameters:
      - description: 撤销角色请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RevokeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 撤销角色
      tags:
      - Authorization-Assignments
  /authz/assignments/subject:
    get:
      parameters:
      - description: 主体类型
        enum:
        - user
        - group
        in: query
        name: subject_type
        required: true
        type: string
      - description: 主体ID
        in: query
        name: subject_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AssignmentResponse'
                  type: array
              type: object
      summary: 列出主体的角色分配
      tags:
      - Authorization-Assignments
  /authz/policies:
    delete:
      consumes:
      - application/json
      parameters:
      - description: 移除策略请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RemovePolicyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 移除策略规则
      tags:
      - Authorization-Policies
    post:
      consumes:
      - application/json
      parameters:
      - description: 添加策略请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AddPolicyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 添加策略规则
      tags:
      - Authorization-Policies
  /authz/policies/version:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.PolicyVersionResponse'
              type: object
      summary: 获取当前策略版本
      tags:
      - Authorization-Policies
  /authz/resources:
    get:
      parameters:
      - description: 应用名称
        in: query
        name: app_name
        type: string
      - description: 域
        in: query
        name: domain
        type: string
      - description: 类型
        in: query
        name: type
        type: string
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ListResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse'
                  type: array
              type: object
      summary: 列出资源
      tags:
      - Authorization-Resources
    post:
      consumes:
      - application/json
      parameters:
      - description: 创建资源请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.CreateResourceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse'
              type: object
      summary: 创建资源
      tags:
      - Authorization-Resources
  /authz/resources/{id}:
    delete:
      parameters:
      - description: 资源ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 删除资源
      tags:
      - Authorization-Resources
    get:
      parameters:
      - description: 资源ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse'
              type: object
      summary: 获取资源详情
      tags:
      - Authorization-Resources
    put:
      consumes:
      - application/json
      parameters:
      - description: 资源ID
        in: path
        name: id
        required: true
        type: string
      - description: 更新资源请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.UpdateResourceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse'
              type: object
      summary: 更新资源
      tags:
      - Authorization-Resources
  /authz/resources/key/{key}:
    get:
      parameters:
      - description: 资源键
        in: path
        name: key
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ResourceResponse'
              type: object
      summary: 根据键获取资源
      tags:
      - Authorization-Resources
  /authz/resources/validate-action:
    post:
      consumes:
      - application/json
      parameters:
      - description: 验证动作请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ValidateActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ValidateActionResponse'
              type: object
      summary: 验证资源动作
      tags:
      - Authorization-Resources
  /authz/roles:
    get:
      parameters:
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.ListResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RoleResponse'
                  type: array
              type: object
      summary: 列出角色
      tags:
      - Authorization-Roles
    post:
      consumes:
      - application/json
      parameters:
      - description: 创建角色请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.CreateRoleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RoleResponse'
              type: object
      summary: 创建角色
      tags:
      - Authorization-Roles
  /authz/roles/{id}:
    delete:
      parameters:
      - description: 角色ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
      summary: 删除角色
      tags:
      - Authorization-Roles
    get:
      parameters:
      - description: 角色ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RoleResponse'
              type: object
      summary: 获取角色详情
      tags:
      - Authorization-Roles
    put:
      consumes:
      - application/json
      parameters:
      - description: 角色ID
        in: path
        name: id
        required: true
        type: string
      - description: 更新角色请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.UpdateRoleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.RoleResponse'
              type: object
      summary: 更新角色
      tags:
      - Authorization-Roles
  /authz/roles/{id}/assignments:
    get:
      parameters:
      - description: 角色ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.AssignmentResponse'
                  type: array
              type: object
      summary: 列出角色的分配记录
      tags:
      - Authorization-Assignments
  /authz/roles/{id}/policies:
    get:
      parameters:
      - description: 角色ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.Response'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_authz_restful_dto.PolicyRuleResponse'
                  type: array
              type: object
      summary: 获取角色的策略列表
      tags:
      - Authorization-Policies
  /children/{id}:
    get:
      consumes:
      - application/json
      description: 根据儿童 ID 查询儿童详细档案，只能查询当前用户监护的孩子
      parameters:
      - description: 儿童 ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限访问此儿童
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 儿童不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 查询儿童档案（仅限自己监护的孩子）
      tags:
      - Identity-Children
    patch:
      consumes:
      - application/json
      description: 部分更新儿童档案信息，只能更新当前用户监护的孩子
      parameters:
      - description: 儿童 ID
        in: path
        name: id
        required: true
        type: string
      - description: 更新儿童请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.ChildUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "403":
          description: 无权限修改此儿童
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "404":
          description: 儿童不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 更新儿童档案（仅限自己监护的孩子）
      tags:
      - Identity-Children
  /children/register:
    post:
      consumes:
      - application/json
      description: 创建儿童档案并自动将当前用户设置为监护人（身份证可不填写）
      parameters:
      - description: 注册儿童请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.ChildRegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 注册成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildRegisterResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "409":
          description: 儿童已存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 注册儿童档案并建立监护关系
      tags:
      - Identity-Children
  /children/search:
    get:
      consumes:
      - application/json
      description: 根据姓名、生日等信息搜索相似的儿童档案（用于运营查询）
      parameters:
      - description: 儿童姓名
        in: query
        name: name
        type: string
      - description: 出生日期 YYYY-MM-DD
        in: query
        name: dob
        type: string
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildPageResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 搜索儿童
      tags:
      - Identity-Children
  /guardians:
    get:
      consumes:
      - application/json
      description: 查询用户或儿童的监护关系列表
      parameters:
      - description: 用户 ID
        in: query
        name: user_id
        type: string
      - description: 儿童 ID
        in: query
        name: child_id
        type: string
      - description: 是否仅查询活跃的监护关系
        in: query
        name: active
        type: boolean
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipPageResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 查询监护关系
      tags:
      - Identity-Guardianship
  /guardians/grant:
    post:
      consumes:
      - application/json
      description: 将用户设置为儿童的监护人
      parameters:
      - description: 授予监护请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.GuardianGrantRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 授予成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.GuardianshipResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "409":
          description: 监护关系已存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 授予监护关系
      tags:
      - Identity-Guardianship
  /idp/wechat-apps:
    post:
      consumes:
      - application/json
      parameters:
      - description: 创建微信应用请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.CreateWechatAppRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 创建成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.WechatAppResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 创建微信应用
      tags:
      - IDP-Wechat
  /idp/wechat-apps/{app_id}:
    get:
      consumes:
      - application/json
      parameters:
      - description: 微信应用 ID
        in: path
        name: app_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.WechatAppResponse'
        "404":
          description: 应用不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 查询微信应用
      tags:
      - IDP-Wechat
  /idp/wechat-apps/{app_id}/access-token:
    get:
      consumes:
      - application/json
      parameters:
      - description: 微信应用 ID
        in: path
        name: app_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.AccessTokenResponse'
        "404":
          description: 应用不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 获取访问令牌（带缓存和自动刷新）
      tags:
      - IDP-Wechat
  /idp/wechat-apps/refresh-access-token:
    post:
      consumes:
      - application/json
      parameters:
      - description: 刷新访问令牌请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RefreshAccessTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 刷新成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.AccessTokenResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "404":
          description: 应用不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 强制刷新访问令牌
      tags:
      - IDP-Wechat
  /idp/wechat-apps/rotate-auth-secret:
    post:
      consumes:
      - application/json
      parameters:
      - description: 轮换认证密钥请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RotateAuthSecretRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 轮换成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.RotateSecretResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "404":
          description: 应用不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 轮换认证密钥（AppSecret）
      tags:
      - IDP-Wechat
  /idp/wechat-apps/rotate-msg-secret:
    post:
      consumes:
      - application/json
      parameters:
      - description: 轮换消息密钥请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_request.RotateMsgSecretRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 轮换成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.RotateSecretResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "404":
          description: 应用不存在
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_idp_restful_response.ErrorResponse'
      summary: 轮换消息加解密密钥
      tags:
      - IDP-Wechat
  /me:
    get:
      consumes:
      - application/json
      description: 获取当前登录用户的资料信息
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.UserResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 获取当前用户信息
      tags:
      - Identity-Users
    patch:
      consumes:
      - application/json
      description: 部分更新当前登录用户的信息，支持更新昵称和联系方式
      parameters:
      - description: 更新用户请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_request.UserUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 更新成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.UserResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 更新当前用户信息
      tags:
      - Identity-Users
  /me/children:
    get:
      consumes:
      - application/json
      description: 获取当前登录用户作为监护人的所有儿童档案
      parameters:
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 查询成功
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_internal_apiserver_interface_uc_restful_response.ChildPageResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/github_com_FangcunMount_iam-contracts_pkg_core.ErrResponse'
      security:
      - BearerAuth: []
      summary: 获取当前用户的儿童档案列表
      tags:
      - Identity-Children
securityDefinitions:
  BearerAuth:
    description: 'JWT 认证令牌，格式: Bearer {access_token}'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
tags:
- description: 认证 - 用户登录
  name: 认证
- description: 账号管理 - 创建、查询、绑定第三方账号
  name: 账户管理
- description: 密钥管理 - JWT 签名验证公钥集
  name: Authentication-JWKS
- description: 用户管理 - 创建、查询、更新用户信息
  name: Identity-Users
- description: 儿童管理 - 注册、查询、更新儿童档案
  name: Identity-Children
- description: 监护关系 - 授予、撤销、查询监护权
  name: Identity-Guardianship
- description: 角色管理 - 创建、查询、更新、删除角色
  name: Authorization-Roles
- description: 角色分配 - 授予、撤销用户或组的角色
  name: Authorization-Assignments
- description: 策略管理 - 添加、移除 RBAC 策略规则
  name: Authorization-Policies
- description: 资源管理 - 创建、查询、更新受保护资源
  name: Authorization-Resources
- description: 微信集成 - 登录、应用管理、密钥轮换、令牌获取
  name: IDP-Wechat
- description: 健康检查 - 各模块健康状态
  name: Health
