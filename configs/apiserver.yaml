app:
  name: "iam"
  version: "1.0.0"
  mode: "production"  # development, production

# 服务器配置
server:
  name: "iam"
  address: "0.0.0.0"
  port: 8080  # 标准端口，方便代理
  port-ssl: 8443
  read-timeout: 60    # 秒
  write-timeout: 60   # 秒
  run-mode: "release"   # Gin 开发模式, 可选值有：debug, release, test

# MySQL 配置
mysql:
  host: "127.0.0.1:3306"
  username: "iam"
  password: "iam_contracts_pass123"
  database: "iam_contracts"
  max-idle-conns: 10
  max-open-conns: 100
  conn-max-lifetime: 3600  # 秒
  log-level: 1 # GORM log level, 1: silent, 2:error, 3:warn, 4:info (生产环境使用 silent)

# 数据库迁移配置
migration:
  enabled: true  # 是否启用自动迁移（生产环境建议启用）
  autoseed: false  # 是否自动加载种子数据（仅开发/测试环境）
  database: "iam_contracts"  # 数据库名称

# Redis 配置（双实例架构）
redis:
  # Cache Redis - 用于缓存、会话、限流等临时数据
  cache:
    host: "127.0.0.1"
    port: 6379
    password: ""
    database: 0  # 缓存使用 DB 0
    max-idle: 50
    max-active: 100
    timeout: 5
    enable-cluster: false
    use-ssl: false
  
  # Store Redis - 用于持久化存储、队列、发布订阅等
  store:
    host: "127.0.0.1"
    port: 6380
    password: ""
    database: 1  # 存储使用 DB 1
    max-idle: 50
    max-active: 100
    timeout: 5
    enable-cluster: false
    use-ssl: false

# 日志配置
log:
  disable-caller: true
  disable-stacktrace: true
  level: debug
  format: console
  output-paths: [/var/log/iam-contracts/app.log, stdout]

# jwt 配置
jwt:
  secret: ""
  expire: 86400

# cors 配置
cors:
  allowed-origins:
    - "*"
  allowed-methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allowed-headers:
    - "Content-Type"
    - "Authorization"

# HTTPS 服务器相关配置
tls:
  cert: /etc/iam-contracts/ssl/yangshujie.com.crt
  key: /etc/iam-contracts/ssl/yangshujie.com.key
  strict: false

# IDP 模块配置
idp:
  encryption-key: "CHANGE_ME_WITH_32_BYTE_BASE64_SECRET"  # 占位符，请通过安全渠道注入32字节密钥

insecure:
  bind-address: 0.0.0.0  # 允许外部访问,用于 Docker 端口映射
  bind-port: 9080

secure:
  bind-address: 0.0.0.0
  bind-port: 9444
  tls:
    cert-file: /etc/iam-contracts/ssl/yangshujie.com.crt
    private-key-file: /etc/iam-contracts/ssl/yangshujie.com.key
