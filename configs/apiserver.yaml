app:
  name: "iam"
  version: "1.0.0"
  mode: "production"  # development, production

# æœåŠ¡å™¨é…ç½®
server:
  name: "iam"
  address: "0.0.0.0"
  port: 8080  # æ ‡å‡†ç«¯å£ï¼Œæ–¹ä¾¿ä»£ç†
  port-ssl: 8443
  read-timeout: 60    # ç§’
  write-timeout: 60   # ç§’
  run-mode: "release"   # Gin å¼€å‘æ¨¡å¼, å¯é€‰å€¼æœ‰ï¼šdebug, release, test

# MySQL é…ç½®
mysql:
  host: "127.0.0.1:3306"
  username: "iam"
  password: "iam_contracts_pass123"
  database: "iam_contracts"
  max-idle-conns: 10
  max-open-conns: 100
  conn-max-lifetime: 3600  # ç§’
  log-level: 4 # GORM log level, 1: silent, 2:error, 3:warn, 4:info (ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ silent)

# æ•°æ®åº“è¿ç§»é…ç½®
migration:
  enabled: true  # æ˜¯å¦å¯ç”¨è‡ªåŠ¨è¿ç§»ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®å¯ç”¨ï¼‰
  autoseed: false  # æ˜¯å¦è‡ªåŠ¨åŠ è½½ç§å­æ•°æ®ï¼ˆä»…å¼€å‘/æµ‹è¯•ç¯å¢ƒï¼‰
  database: "iam_contracts"  # æ•°æ®åº“åç§°

# Redis é…ç½®ï¼ˆåŒå®ä¾‹æ¶æ„ï¼‰
redis:
  # Cache Redis - ç”¨äºç¼“å­˜ã€ä¼šè¯ã€é™æµç­‰ä¸´æ—¶æ•°æ®
  cache:
    host: "127.0.0.1"
    port: 6379
    password: ""
    database: 0  # ç¼“å­˜ä½¿ç”¨ DB 0
    max-idle: 50
    max-active: 100
    timeout: 5
    enable-cluster: false
    use-ssl: false
  
  # Store Redis - ç”¨äºæŒä¹…åŒ–å­˜å‚¨ã€é˜Ÿåˆ—ã€å‘å¸ƒè®¢é˜…ç­‰
  store:
    host: "127.0.0.1"
    port: 6380
    password: ""
    database: 1  # å­˜å‚¨ä½¿ç”¨ DB 1
    max-idle: 50
    max-active: 100
    timeout: 5
    enable-cluster: false
    use-ssl: false

# æ—¥å¿—é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒ - ä½¿ç”¨ component-base v0.2.7 æœ€æ–°åŠŸèƒ½ï¼‰
log:
  # åŸºç¡€é…ç½®
  disable-caller: true          # ç”Ÿäº§ç¯å¢ƒç¦ç”¨è°ƒç”¨è€…ä¿¡æ¯ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
  disable-stacktrace: true      # ä»…åœ¨ panic æ—¶è®°å½•å †æ ˆ
  level: debug                   # ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ debug çº§åˆ«
  format: json                  # JSON æ ¼å¼ä¾¿äºæ—¥å¿—æ”¶é›†å’Œåˆ†æ
  enable-color: false           # æ–‡ä»¶è¾“å‡ºç¦ç”¨é¢œè‰²
  development: false            # ç”Ÿäº§æ¨¡å¼
  name: "iam-apiserver"         # æ—¥å¿—åç§°
  
  # è¾“å‡ºè·¯å¾„
  output-paths: 
    - /var/log/iam-contracts/app.log
  error-output-paths: 
    - /var/log/iam-contracts/error.log
  
  # ğŸ“Š æ—¥å¿—è½®è½¬é…ç½®
  max-size: 100                 # å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ 100MB
  max-age: 7                   # ä¿ç•™ 7 å¤©
  max-backups: 7               # ä¿ç•™ 7 ä¸ªå¤‡ä»½æ–‡ä»¶
  compress: true                # å‹ç¼©æ—§æ–‡ä»¶èŠ‚çœç©ºé—´
  
  # â° æŒ‰æ—¶é—´è½®è½¬ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼‰
  enable-time-rotation: true    # å¯ç”¨æŒ‰æ—¶é—´è½®è½¬
  time-rotation-format: "2006-01-02"  # æŒ‰å¤©è½®è½¬
  
  # ğŸ¯ åˆ†çº§è¾“å‡ºï¼ˆç”Ÿäº§ç¯å¢ƒé…ç½®ï¼‰
  enable-level-output: true     # å¯ç”¨åˆ†çº§è¾“å‡º
  level-output-mode: "above"    # è¾“å‡ºè¯¥çº§åˆ«åŠä»¥ä¸Š
  level-output-paths:
    info: 
      - /var/log/iam-contracts/app.log  # INFO åŠä»¥ä¸Šè®°å½•åˆ°ä¸»æ—¥å¿—
    warn:
      - /var/log/iam-contracts/warn.log # WARN åŠä»¥ä¸Šå•ç‹¬è®°å½•
    error:
      - /var/log/iam-contracts/error.log # ERROR å•ç‹¬è®°å½•

# jwt é…ç½®
jwt:
  secret: ""
  expire: 86400

# cors é…ç½®
cors:
  allowed-origins:
    - "*"
  allowed-methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allowed-headers:
    - "Content-Type"
    - "Authorization"

# HTTPS æœåŠ¡å™¨ç›¸å…³é…ç½®
tls:
  cert: /etc/iam-contracts/ssl/yangshujie.com.crt
  key: /etc/iam-contracts/ssl/yangshujie.com.key
  strict: false

# IDP æ¨¡å—é…ç½®
idp:
  encryption-key: "CHANGE_ME_WITH_32_BYTE_BASE64_SECRET"  # å ä½ç¬¦ï¼Œè¯·é€šè¿‡å®‰å…¨æ¸ é“æ³¨å…¥32å­—èŠ‚å¯†é’¥

insecure:
  bind-address: 0.0.0.0  # å…è®¸å¤–éƒ¨è®¿é—®,ç”¨äº Docker ç«¯å£æ˜ å°„
  bind-port: 9080

secure:
  bind-address: 0.0.0.0
  bind-port: 9444
  tls:
    cert-file: /etc/iam-contracts/ssl/yangshujie.com.crt
    private-key-file: /etc/iam-contracts/ssl/yangshujie.com.key
