# ç»Ÿä¸€å¼‚å¸¸å¤„ç†

## ğŸ¯ è®¾è®¡ç†å¿µ

ç»Ÿä¸€å¼‚å¸¸å¤„ç†æ˜¯æ¡†æ¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæä¾›æ ‡å‡†åŒ–çš„é”™è¯¯ç ã€é”™è¯¯æ¶ˆæ¯å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚é€šè¿‡ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ï¼Œç¡®ä¿APIå“åº”çš„ä¸€è‡´æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Error Handling System                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                Error Types                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚   Business  â”‚  â”‚   System    â”‚  â”‚   Validationâ”‚    â”‚ â”‚
â”‚  â”‚  â”‚    Error    â”‚  â”‚    Error    â”‚  â”‚    Error    â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                Error Codes                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚   Success   â”‚  â”‚   Client    â”‚  â”‚    Server   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚    Codes    â”‚  â”‚    Codes    â”‚  â”‚    Codes    â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                Error Handlers                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚   Global    â”‚  â”‚   Custom    â”‚  â”‚   Logging   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚   Handler   â”‚  â”‚   Handler   â”‚  â”‚   Handler   â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### é”™è¯¯ç å®šä¹‰

```go
// æˆåŠŸç 
const (
    Success = 200
)

// å®¢æˆ·ç«¯é”™è¯¯ç  (400-499)
const (
    ErrInvalidRequest        = 400
    ErrUnauthorized          = 401
    ErrForbidden            = 403
    ErrNotFound             = 404
    ErrMethodNotAllowed     = 405
    ErrConflict             = 409
    ErrValidationFailed     = 422
    ErrTooManyRequests      = 429
)

// æœåŠ¡å™¨é”™è¯¯ç  (500-599)
const (
    ErrInternalServerError  = 500
    ErrNotImplemented       = 501
    ErrServiceUnavailable   = 503
    ErrDatabaseError        = 510
    ErrCacheError           = 511
    ErrExternalServiceError = 512
)

// ä¸šåŠ¡é”™è¯¯ç  (1000-9999)
const (
    ErrUserNotFound         = 1001
    ErrUserAlreadyExists    = 1002
    ErrInvalidCredentials   = 1003
    ErrTokenExpired         = 1004
    ErrTokenInvalid         = 1005
    ErrPermissionDenied     = 1006
    ErrResourceNotFound     = 1007
    ErrResourceConflict     = 1008
    ErrModuleInitializationFailed = 1009
)
```

### é”™è¯¯ç»“æ„

```go
// Error é”™è¯¯ç»“æ„
type Error struct {
    Code    int         `json:"code"`
    Message string      `json:"message"`
    Details interface{} `json:"details,omitempty"`
    Stack   string      `json:"stack,omitempty"`
}

// ErrorResponse APIé”™è¯¯å“åº”
type ErrorResponse struct {
    Code    int         `json:"code"`
    Message string      `json:"message"`
    Data    interface{} `json:"data,omitempty"`
    Error   *Error      `json:"error,omitempty"`
}
```

### é”™è¯¯åˆ›å»ºå‡½æ•°

```go
// NewError åˆ›å»ºæ–°é”™è¯¯
func NewError(code int, message string) *Error {
    return &Error{
        Code:    code,
        Message: message,
    }
}

// NewErrorWithDetails åˆ›å»ºå¸¦è¯¦æƒ…çš„é”™è¯¯
func NewErrorWithDetails(code int, message string, details interface{}) *Error {
    return &Error{
        Code:    code,
        Message: message,
        Details: details,
    }
}

// NewErrorWithStack åˆ›å»ºå¸¦å †æ ˆçš„é”™è¯¯
func NewErrorWithStack(code int, message string, stack string) *Error {
    return &Error{
        Code:    code,
        Message: message,
        Stack:   stack,
    }
}
```

## ğŸ”§ é”™è¯¯å¤„ç†æœºåˆ¶

### å…¨å±€é”™è¯¯å¤„ç†å™¨

```go
// GlobalErrorHandler å…¨å±€é”™è¯¯å¤„ç†å™¨
func GlobalErrorHandler() gin.HandlerFunc {
    return func(c *gin.Context) {
        c.Next()

        // æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
        if len(c.Errors) > 0 {
            err := c.Errors.Last().Err
            
            // è®°å½•é”™è¯¯æ—¥å¿—
            logger := log.FromContext(c.Request.Context())
            logger.Errorw("Request error",
                "error", err.Error(),
                "method", c.Request.Method,
                "path", c.Request.URL.Path,
                "status", c.Writer.Status(),
            )

            // æ ¹æ®é”™è¯¯ç±»å‹è¿”å›ç›¸åº”çš„å“åº”
            response := handleError(err)
            c.JSON(response.Code, response)
        }
    }
}

// handleError å¤„ç†é”™è¯¯å¹¶è¿”å›æ ‡å‡†å“åº”
func handleError(err error) *ErrorResponse {
    switch e := err.(type) {
    case *Error:
        return &ErrorResponse{
            Code:    e.Code,
            Message: e.Message,
            Error:   e,
        }
    case *ValidationError:
        return &ErrorResponse{
            Code:    ErrValidationFailed,
            Message: "Validation failed",
            Error: &Error{
                Code:    ErrValidationFailed,
                Message: "Validation failed",
                Details: e.Details,
            },
        }
    case *BusinessError:
        return &ErrorResponse{
            Code:    e.Code,
            Message: e.Message,
            Error: &Error{
                Code:    e.Code,
                Message: e.Message,
                Details: e.Details,
            },
        }
    default:
        // æœªçŸ¥é”™è¯¯ï¼Œè¿”å›500
        return &ErrorResponse{
            Code:    ErrInternalServerError,
            Message: "Internal server error",
            Error: &Error{
                Code:    ErrInternalServerError,
                Message: "Internal server error",
            },
        }
    }
}
```

### è‡ªå®šä¹‰é”™è¯¯ç±»å‹

```go
// ValidationError éªŒè¯é”™è¯¯
type ValidationError struct {
    Field   string      `json:"field"`
    Value   interface{} `json:"value"`
    Message string      `json:"message"`
    Details interface{} `json:"details,omitempty"`
}

func (v *ValidationError) Error() string {
    return fmt.Sprintf("validation failed for field %s: %s", v.Field, v.Message)
}

// BusinessError ä¸šåŠ¡é”™è¯¯
type BusinessError struct {
    Code    int         `json:"code"`
    Message string      `json:"message"`
    Details interface{} `json:"details,omitempty"`
}

func (b *BusinessError) Error() string {
    return fmt.Sprintf("business error %d: %s", b.Code, b.Message)
}

// SystemError ç³»ç»Ÿé”™è¯¯
type SystemError struct {
    Code    int         `json:"code"`
    Message string      `json:"message"`
    Stack   string      `json:"stack,omitempty"`
}

func (s *SystemError) Error() string {
    return fmt.Sprintf("system error %d: %s", s.Code, s.Message)
}
```

## ğŸ”„ é”™è¯¯å¤„ç†æµç¨‹

### é”™è¯¯å¤„ç†ä¸­é—´ä»¶

```go
// ErrorHandlingMiddleware é”™è¯¯å¤„ç†ä¸­é—´ä»¶
func ErrorHandlingMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        // è®¾ç½®æ¢å¤å‡½æ•°
        defer func() {
            if r := recover(); r != nil {
                // è®°å½•panicæ—¥å¿—
                logger := log.FromContext(c.Request.Context())
                logger.Errorw("Panic recovered",
                    "panic", r,
                    "method", c.Request.Method,
                    "path", c.Request.URL.Path,
                )

                // è¿”å›500é”™è¯¯
                c.JSON(http.StatusInternalServerError, &ErrorResponse{
                    Code:    ErrInternalServerError,
                    Message: "Internal server error",
                    Error: &Error{
                        Code:    ErrInternalServerError,
                        Message: "Internal server error",
                    },
                })
            }
        }()

        c.Next()
    }
}
```

### é”™è¯¯å“åº”æ ¼å¼

```go
// æˆåŠŸå“åº”
{
    "code": 200,
    "message": "Success",
    "data": {
        "user_id": 123,
        "username": "admin"
    }
}

// é”™è¯¯å“åº”
{
    "code": 400,
    "message": "Bad Request",
    "error": {
        "code": 400,
        "message": "Invalid request parameters",
        "details": {
            "field": "email",
            "value": "invalid-email",
            "message": "Invalid email format"
        }
    }
}

// éªŒè¯é”™è¯¯å“åº”
{
    "code": 422,
    "message": "Validation failed",
    "error": {
        "code": 422,
        "message": "Validation failed",
        "details": [
            {
                "field": "username",
                "value": "",
                "message": "Username is required"
            },
            {
                "field": "email",
                "value": "invalid-email",
                "message": "Invalid email format"
            }
        ]
    }
}
```

## ğŸ¨ é”™è¯¯å¤„ç†æ¨¡å¼

### 1. é”™è¯¯åŒ…è£…

```go
// ä½¿ç”¨errorsåŒ…åŒ…è£…é”™è¯¯
import "github.com/pkg/errors"

func processUser(userID int64) error {
    user, err := getUser(userID)
    if err != nil {
        return errors.Wrapf(err, "failed to get user %d", userID)
    }
    
    if err := validateUser(user); err != nil {
        return errors.Wrap(err, "user validation failed")
    }
    
    return nil
}
```

### 2. é”™è¯¯è½¬æ¢

```go
// å°†åº•å±‚é”™è¯¯è½¬æ¢ä¸ºä¸šåŠ¡é”™è¯¯
func getUser(userID int64) (*User, error) {
    user, err := userRepo.FindByID(userID)
    if err != nil {
        if errors.Is(err, gorm.ErrRecordNotFound) {
            return nil, &BusinessError{
                Code:    ErrUserNotFound,
                Message: fmt.Sprintf("User %d not found", userID),
            }
        }
        return nil, &SystemError{
            Code:    ErrDatabaseError,
            Message: "Database error",
        }
    }
    return user, nil
}
```

### 3. é”™è¯¯èšåˆ

```go
// èšåˆå¤šä¸ªé”™è¯¯
type AggregateError struct {
    Errors []error
}

func (a *AggregateError) Error() string {
    if len(a.Errors) == 0 {
        return "no errors"
    }
    
    messages := make([]string, len(a.Errors))
    for i, err := range a.Errors {
        messages[i] = err.Error()
    }
    
    return fmt.Sprintf("multiple errors: %s", strings.Join(messages, "; "))
}

func (a *AggregateError) Add(err error) {
    if err != nil {
        a.Errors = append(a.Errors, err)
    }
}

func (a *AggregateError) HasErrors() bool {
    return len(a.Errors) > 0
}
```

## ğŸ“ˆ é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

### 1. é”™è¯¯ç è®¾è®¡

```go
// é”™è¯¯ç å‘½åè§„èŒƒ
const (
    // æ¨¡å—å‰ç¼€ + é”™è¯¯ç±»å‹ + å…·ä½“é”™è¯¯
    ErrUserNotFound         = 1001  // ç”¨æˆ·æ¨¡å— - æœªæ‰¾åˆ°
    ErrUserAlreadyExists    = 1002  // ç”¨æˆ·æ¨¡å— - å·²å­˜åœ¨
    ErrUserInvalidPassword  = 1003  // ç”¨æˆ·æ¨¡å— - å¯†ç æ— æ•ˆ
    
    ErrAuthTokenExpired     = 2001  // è®¤è¯æ¨¡å— - Tokenè¿‡æœŸ
    ErrAuthTokenInvalid     = 2002  // è®¤è¯æ¨¡å— - Tokenæ— æ•ˆ
    ErrAuthPermissionDenied = 2003  // è®¤è¯æ¨¡å— - æƒé™ä¸è¶³
)
```

### 2. é”™è¯¯æ¶ˆæ¯è®¾è®¡

```go
// é”™è¯¯æ¶ˆæ¯åº”è¯¥ï¼š
// 1. æ¸…æ™°æ˜ç¡®
// 2. å¯¹ç”¨æˆ·å‹å¥½
// 3. åŒ…å«å¿…è¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
// 4. é¿å…æš´éœ²æ•æ„Ÿä¿¡æ¯

// å¥½çš„é”™è¯¯æ¶ˆæ¯
"User with email 'user@example.com' already exists"
"Password must be at least 8 characters long"
"Invalid token: token has expired"

// ä¸å¥½çš„é”™è¯¯æ¶ˆæ¯
"Error occurred"
"Something went wrong"
"Database error: connection refused"
```

### 3. é”™è¯¯æ—¥å¿—è®°å½•

```go
// è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
func logError(ctx context.Context, err error, req *http.Request) {
    logger := log.FromContext(ctx)
    
    logger.Errorw("Request error",
        "error", err.Error(),
        "method", req.Method,
        "path", req.URL.Path,
        "user_agent", req.UserAgent(),
        "remote_addr", req.RemoteAddr,
        "request_id", getRequestID(ctx),
    )
    
    // è®°å½•å †æ ˆä¿¡æ¯ï¼ˆä»…åœ¨å¼€å‘ç¯å¢ƒï¼‰
    if config.IsDevelopment() {
        logger.Errorw("Error stack trace",
            "stack", string(debug.Stack()),
        )
    }
}
```

### 4. é”™è¯¯æ¢å¤

```go
// ä¼˜é›…çš„é”™è¯¯æ¢å¤
func gracefulErrorRecovery() {
    defer func() {
        if r := recover(); r != nil {
            log.Errorw("Application panic recovered",
                "panic", r,
                "stack", string(debug.Stack()),
            )
            
            // å‘é€å‘Šè­¦
            sendAlert("Application panic", r)
            
            // ä¼˜é›…å…³é—­
            gracefulShutdown()
        }
    }()
    
    // åº”ç”¨ç¨‹åºä¸»é€»è¾‘
    runApplication()
}
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```go
func TestErrorHandling(t *testing.T) {
    // æµ‹è¯•ä¸šåŠ¡é”™è¯¯
    err := &BusinessError{
        Code:    ErrUserNotFound,
        Message: "User not found",
    }
    
    response := handleError(err)
    assert.Equal(t, ErrUserNotFound, response.Code)
    assert.Equal(t, "User not found", response.Message)
    
    // æµ‹è¯•éªŒè¯é”™è¯¯
    validationErr := &ValidationError{
        Field:   "email",
        Value:   "invalid-email",
        Message: "Invalid email format",
    }
    
    response = handleError(validationErr)
    assert.Equal(t, ErrValidationFailed, response.Code)
    assert.Equal(t, "Validation failed", response.Message)
}
```

### é›†æˆæµ‹è¯•

```go
func TestErrorMiddleware(t *testing.T) {
    router := gin.New()
    router.Use(ErrorHandlingMiddleware())
    router.Use(GlobalErrorHandler())
    
    router.GET("/test-error", func(c *gin.Context) {
        c.Error(&BusinessError{
            Code:    ErrUserNotFound,
            Message: "User not found",
        })
    })
    
    req := httptest.NewRequest("GET", "/test-error", nil)
    w := httptest.NewRecorder()
    router.ServeHTTP(w, req)
    
    assert.Equal(t, http.StatusOK, w.Code)
    
    var response ErrorResponse
    err := json.Unmarshal(w.Body.Bytes(), &response)
    assert.NoError(t, err)
    assert.Equal(t, ErrUserNotFound, response.Code)
}
```

## ğŸ¯ ç›‘æ§å’Œå‘Šè­¦

### é”™è¯¯ç›‘æ§

```go
// é”™è¯¯è®¡æ•°å™¨
var (
    errorCounter = prometheus.NewCounterVec(
        prometheus.CounterOpts{
            Name: "http_errors_total",
            Help: "Total number of HTTP errors",
        },
        []string{"code", "method", "path"},
    )
)

// è®°å½•é”™è¯¯æŒ‡æ ‡
func recordError(code int, method, path string) {
    errorCounter.WithLabelValues(
        strconv.Itoa(code),
        method,
        path,
    ).Inc()
}
```

### é”™è¯¯å‘Šè­¦

```go
// é”™è¯¯ç‡å‘Šè­¦
func checkErrorRate() {
    errorRate := getErrorRate()
    if errorRate > 0.1 { // é”™è¯¯ç‡è¶…è¿‡10%
        sendAlert("High error rate detected", map[string]interface{}{
            "error_rate": errorRate,
            "threshold":  0.1,
        })
    }
}

// ç‰¹å®šé”™è¯¯å‘Šè­¦
func checkSpecificErrors() {
    criticalErrors := getCriticalErrors()
    for _, err := range criticalErrors {
        if err.Count > 10 { // ç‰¹å®šé”™è¯¯è¶…è¿‡10æ¬¡
            sendAlert("Critical error detected", map[string]interface{}{
                "error_code": err.Code,
                "error_message": err.Message,
                "count": err.Count,
            })
        }
    }
}
```

## ğŸ“Š é”™è¯¯åˆ†æ

### é”™è¯¯åˆ†ç±»ç»Ÿè®¡

```sql
-- æŒ‰é”™è¯¯ç±»å‹ç»Ÿè®¡
SELECT 
    error_code,
    error_message,
    COUNT(*) as count,
    DATE(created_at) as date
FROM error_logs 
WHERE created_at >= DATE_SUB(NOW(), INTERVAL 7 DAY)
GROUP BY error_code, error_message, DATE(created_at)
ORDER BY count DESC;

-- æŒ‰æ—¶é—´åˆ†å¸ƒç»Ÿè®¡
SELECT 
    HOUR(created_at) as hour,
    COUNT(*) as error_count
FROM error_logs 
WHERE created_at >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
GROUP BY HOUR(created_at)
ORDER BY hour;
```

### é”™è¯¯è¶‹åŠ¿åˆ†æ

```go
// é”™è¯¯è¶‹åŠ¿åˆ†æ
type ErrorTrend struct {
    Date       string  `json:"date"`
    ErrorCount int     `json:"error_count"`
    ErrorRate  float64 `json:"error_rate"`
}

func analyzeErrorTrend(days int) []ErrorTrend {
    trends := make([]ErrorTrend, days)
    
    for i := 0; i < days; i++ {
        date := time.Now().AddDate(0, 0, -i)
        errorCount := getErrorCountByDate(date)
        totalRequests := getTotalRequestsByDate(date)
        errorRate := float64(errorCount) / float64(totalRequests)
        
        trends[i] = ErrorTrend{
            Date:       date.Format("2006-01-02"),
            ErrorCount: errorCount,
            ErrorRate:  errorRate,
        }
    }
    
    return trends
}
```
